

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Crumpet &mdash; CRUMPET 0.2rc1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Crm" href="CRUMPET.Crm.html" />
    <link rel="prev" title="CRUMPET Classes" href="../documentation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> CRUMPET
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Collisional-Radiative theory</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../input/input.html">The CRUMPET input file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../input/species.html">Species</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../input/background.html">Background</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../input/reactions.html">Reactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../input/custom.html">CUSTOM</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../input/rates.html">Rates</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../input/settings.html">Settings</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">CRUMPET Classes</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Crumpet</a></li>
<li class="toctree-l2"><a class="reference internal" href="CRUMPET.Crm.html">Crm</a></li>
<li class="toctree-l2"><a class="reference internal" href="CRUMPET.RateData.html">RateData</a></li>
<li class="toctree-l2"><a class="reference internal" href="CRUMPET.Reaction.html">Reaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="CRUMPET.Tools.html">Tools</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">CRUMPET examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developments.html">Future developments</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../LICENSE.html">Crumpet license</a><ul class="simple">
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CRUMPET</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../documentation.html">CRUMPET Classes</a> &raquo;</li>
        
      <li>Crumpet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/holm10/CRUMPET/blob/masterobjects/CRUMPET.Crumpet.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="crumpet">
<h1>Crumpet<a class="headerlink" href="#crumpet" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="CRUMPET.Crumpet">
<em class="property">class </em><code class="sig-prename descclassname">CRUMPET.</code><code class="sig-name descname">Crumpet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">'input/CRUMPET.dat'</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">vmax</span><span class="o">=</span><span class="default_value">14</span></em>, <em class="sig-param"><span class="n">nmax</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">NP</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">isotope</span><span class="o">=</span><span class="default_value">'H'</span></em>, <em class="sig-param"><span class="n">mass</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CRUMPET.crm.Crm</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">CRUMPET.ratedata.RateData</span></code></p>
<p>CRUMPET container object for collsional-radiative models</p>
<p>This class is used to read and parse the input file, the parts
which are passed onto the CRM class that sets up the CRM itself.
Inherits the classes Crm and RateData.</p>
<p>…</p>
<dl class="py attribute">
<dt id="CRUMPET.Crumpet.ver">
<code class="sig-name descname">ver</code><a class="headerlink" href="#CRUMPET.Crumpet.ver" title="Permalink to this definition">¶</a></dt>
<dd><p>a string defining the code version</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>srt</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Summary</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id6" title="CRUMPET.Crumpet.calc_ue_erate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_ue_erate</span></code></a>(Te, ne, E, Tm)</p></td>
<td><p><strong>INCOMPLETE</strong> Calculates the Greenland CRM energy rate coefficients</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id5" title="CRUMPET.Crumpet.calc_ue_nrate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_ue_nrate</span></code></a>(Te, ne, E, Tm)</p></td>
<td><p><strong>INCOMPLETE</strong> Calculates the Greenland CRM particle rate coefficients</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id10" title="CRUMPET.Crumpet.lifetimes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lifetimes</span></code></a>(Te, ne[, E, Ti, ni, Sext, n])</p></td>
<td><p><strong>INCOMPLETE</strong> Species lifetimes perturbation from equilibrium</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id2" title="CRUMPET.Crumpet.plot_crm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_crm</span></code></a>(t, Te, ne[, E, Ti, ni, Sext, Qres, …])</p></td>
<td><p>Plots the CRM results for neutrals in a static background plasma</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id1" title="CRUMPET.Crumpet.plot_depletion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_depletion</span></code></a>(key, n, Te[, Ti, color, ax, …])</p></td>
<td><p>Plots the depletion rate for a given species</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id7" title="CRUMPET.Crumpet.plot_ue_erate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ue_erate</span></code></a>(ratefile, Te, ne[, fig, …])</p></td>
<td><p><strong>INCOMPLETE</strong> Plots the energy rate coefficients read from a crumpet rate file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id4" title="CRUMPET.Crumpet.plot_ue_nrate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_ue_nrate</span></code></a>(ratefile, Te, ne[, fig, …])</p></td>
<td><p><strong>INCOMPLETE</strong> Plots the density rate coefficients read from a crumpet rate file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id9" title="CRUMPET.Crumpet.plotrate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plotrate</span></code></a>(database, name, T, n[, E, logx, …])</p></td>
<td><p>Plots the rate of the requested reaction</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id3" title="CRUMPET.Crumpet.read_ue_crumpet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_ue_crumpet</span></code></a>(nratefile, eratefile)</p></td>
<td><p><strong>INCOMPLETE</strong> Reads a CRUMPET UEDGE rate file and returns the rates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#CRUMPET.Crumpet.solve_crm" title="CRUMPET.Crumpet.solve_crm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_crm</span></code></a>(t, Te, ne[, Ti, ni, E, Tm, Sext, …])</p></td>
<td><p>Solves the time-evolution of the CRM system at given T and n</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id8" title="CRUMPET.Crumpet.spectrum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spectrum</span></code></a>(Te, ne, vol[, E, Ti, ni, Sext, n0, …])</p></td>
<td><p>Plots atomic and molecular spectra</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#CRUMPET.Crumpet.steady_state" title="CRUMPET.Crumpet.steady_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">steady_state</span></code></a>(Te, ne, vol[, E, Ti, ni, Sext, …])</p></td>
<td><p>Solves the steady-state population of atoms and molecules</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id0" title="CRUMPET.Crumpet.write_ue_rates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_ue_rates</span></code></a>([fname, E, Sext, Tm, groundstate])</p></td>
<td><p>Writes UEDGE-compatible tab-delimited rate files</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt id="CRUMPET.Crumpet.calc_ue_erate">
<code class="sig-name descname">calc_ue_erate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">E</span></em>, <em class="sig-param"><span class="n">Tm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.calc_ue_erate" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Calculates the Greenland CRM energy rate coefficients</p>
<p>Includes external sources</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a dict of rate coefficients, with the corresponding
handles:
Hel - electron energy sink/source due to atoms
H2el - electron energy sink/source due to molecules
extel - external electron energy sink/source
Hia - ion/atom energy sink/source due to atoms
H2ia - ion/atom energy sink/source due to molecules
extia - external ion/atom energy sink/source
HV - potential energy sink/source due to atoms
H2V - potential energy sink/source due to molecules
extV - external potential energy sink/source
Hga - atomic line radiation power due to atoms
H2ga - atomic line radiation power due to molecules
extga - external atomic line radiation power
Hgm - molecular line radiation power due to atoms
H2gm - molecular line radiation power due to molecules
extgm - external molecular line radiation power</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.calc_ue_nrate">
<code class="sig-name descname">calc_ue_nrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">E</span></em>, <em class="sig-param"><span class="n">Tm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.calc_ue_nrate" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Calculates the Greenland CRM particle rate coefficients</p>
<p>Includes external sources</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a dict of rate coefficients, with the corresponding
handles:
H0_depl - atom sink
H0_create - atom source
H2_depl - molecular sink
H2_create - molecular source
H0_ext - external (recombination) atom source
H2_ext - external (re-association) molecule sink</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.lifetimes">
<code class="sig-name descname">lifetimes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.lifetimes" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Species lifetimes perturbation from equilibrium</p>
<p>Retrurns a ordered list (according to the input file species) of
the species lifetimes. The species lifetimes are calculated by
an intial guess and a set of sink/source terms that are evolved
to a steady-state. Each species of the steady-state distribution
is then perturbed in order, and a exponential fit is applied to
the decay of the perturbation, determining the lifetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in J</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in m**-3</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature in eV. Default sets Ti=Te</p></li>
<li><p><strong>ni</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion density in cm**-3. Default sets ni=ne</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>n</strong> (<em>list of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – an initial guess for the steady-state densities of length N.
Defaults to n0 defined in the input</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radiative lifetimes of each species as calculated by fitting
an exponential to the decay of the perturbation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.plot_crm">
<code class="sig-name descname">plot_crm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Qres</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">gl</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">14, 8.326231</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figtype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">conservation</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.plot_crm" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the CRM results for neutrals in a static background plasma</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – end-time of simulation in s</p></li>
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature in eV. Default sets Ti=Te</p></li>
<li><p><strong>ni</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion density in cm**-3. Default sets ni=ne</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>gl</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – switch determining wheter to evaluate the Np x Np
Greenland CRM (True) or solve the full NxN system of
ODEs (False)</p></li>
<li><p><strong>n0</strong> (<em>list of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Initial density distribution of the species defined in the
input. List must be of the same length as the species list,
and the order is determined by the input file. Defaults to
the initial densities defined in the input if n0 is None.</p></li>
<li><p><strong>Qres</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Switch determining whether to resolve the Q-species energy
transfer or return the net energy transfer divided into
processes.</p></li>
<li><p><strong>density</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Only returns density rates if True, otherwise evaluates
both density and energy rates</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – Size of the created figure</p></li>
<li><p><strong>savename</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name to save figure by. Figures are saved to
{Crumpet.path}/output{savename}.{figtype}. By default,
the figure is not saved.</p></li>
<li><p><strong>figtype</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'png'</em><em>)</em>) – filetype to save figure as. See matplotlib.pyplot.savefig
for options</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure title</p></li>
<li><p><strong>conservation</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Switch to also plot particle and energy conservation.
Particle conservation does not account for
recombination/ionization gains/losses</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>if fig=None, else returns None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyplot.figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.plot_depletion">
<code class="sig-name descname">plot_depletion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'r'</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 6.25</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">'loglog'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.plot_depletion" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the depletion rate for a given species</p>
<p>Plots a curve or a set of curves for the depletion rate of the
species specified by key. If both n and Te are lists, a set of
T-dependent rate curves are plotted. If either n or Te is a
float, a plot of as a function of the list is created. The
abcissa is Te regardless whether Ti is defined or not</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – handle for the species to plot depletion rate of</p></li>
<li><p><strong>n</strong> (<em>ndarray/list of floats</em><em> or </em><em>float</em>) – plasma density values in cm**-3</p></li>
<li><p><strong>Te</strong> (<em>ndarray/list of floats</em><em> or </em><em>float</em>) – electron temperature values in eV</p></li>
<li><p><strong>Ti</strong> (<em>ndarray/list of floats</em><em> or </em><em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature values in eV. Must be equal in length to
Te. If None, Ti=Te is assumed</p></li>
<li><p><strong>ax</strong> (<em>axes handle</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – axes to plot curves on. If None, a new figure is created</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>,</em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>10</em><em>,</em><em>6.25</em><em>)</em><em>)</em>) – sets figure’s figsize</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>plot</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: loglog</em><em>)</em>) – plot layout specifier, see documentation of plotax.</p></li>
<li><p><strong>**kwargs</strong> – passed to ax.plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>if ax=None, otherwise returns None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyplot.figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.plot_ue_erate">
<code class="sig-name descname">plot_ue_erate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratefile</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">origUE</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">idx</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">12, 8.034446763446727</span></em>, <em class="sig-param"><span class="n">linestyle</span><span class="o">=</span><span class="default_value">'-'</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">1e-17, 1e-11</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">labelapp</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pretitle</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">figtype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">'loglog'</span></em>, <em class="sig-param"><span class="n">ncol</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">colors</span><span class="o">=</span><span class="default_value">['darkcyan', 'b', 'm', 'r']</span></em>, <em class="sig-param"><span class="n">eion</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">ediss</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.plot_ue_erate" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Plots the energy rate coefficients read from a crumpet rate file</p>
<p>Plots the energy rate coefficients for the process with idx, as
explained below. Reads a CRUMPET energy rate file if origUE is
False, or emulates the original UEDGE calculation based on a
CRUMPET density rate file if origUE is True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratefile</strong> (<em>string</em>) – path to Crumpet density rate file relative to Crumpet.path.
Energy file if origUE=False, density file if origUE=True</p></li>
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – size of the created figure</p></li>
<li><p><strong>linestyle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: '-'</em><em>)</em>) – linestyle option for matplotlig.pyplot used in the plot</p></li>
<li><p><strong>savename</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name to save figure by. Figures are saved to
{Crumpet.path}/output{savename}.{figtype}. By default,
the figure is not saved.</p></li>
<li><p><strong>ylim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>1e-7</em><em>, </em><em>1e7</em><em>)</em><em>)</em>) – ordinate limits in cm**3 s**-1</p></li>
<li><p><strong>xlim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – abscissae limits in cm**3 s**-1, defaults to default limits</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – width of lines plotted</p></li>
<li><p><strong>labelapp</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – appendix for plot labels</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – </p></li>
<li><p><strong>figtype</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'png'</em><em>)</em>) – filetype to save figure as. See matplotlib.pyplot.savefig
for options</p></li>
<li><p><strong>title</strong> – figure title. Defaults to temperature and density</p></li>
<li><p><strong>pretitle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – prefix to default title, not used if title is not None</p></li>
<li><p><strong>color</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'k'</em><em>)</em>) – color to be used in plot</p></li>
<li><p><strong>plot</strong> (<em>sting</em><em>, </em><em>optional</em><em> (</em><em>default: 'loglog'</em><em>)</em>) – string of the matplotlib.pyplot.Axes plot option to be used</p></li>
<li><p><strong>origUE</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – switch to use the original UEDGE dissociation rate (True)
or not (False). calculated based on eion and ediss</p></li>
<li><p><strong>eion</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 5</em><em>)</em>) – Value of bbb.eion used in UEDGE: ion birth energy</p></li>
<li><p><strong>ediss</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Value of bbb.ediss used in UEDGE: molecular dissociation
energy</p></li>
<li><p><strong>colors</strong> (<em>list of strings</em><em>, </em><em>optiona</em>) – (default:[‘darkcyan’,’b’,’m’,’r’])
List of colors to be used in the plots</p></li>
<li><p><strong>idx</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Index of appearance of the data block in ratefile:
0 - electron energy sink/source due to atoms
1 - electron energy sink/source due to molecules
2 - external electron energy sink/source
3 - ion/atom energy sink/source due to atoms
4 - ion/atom energy sink/source due to molecules
5 - external ion/atom energy sink/source
6 - potential energy sink/source due to atoms
7 - potential energy sink/source due to molecules
8 - external potential energy sink/source
9 - atomic line radiation power due to atoms
10 - atomic line radiation power due to molecules
11 - external atomic line radiation power
12 - molecular line radiation power due to atoms
13 - molecular line radiation power due to molecules
14 - external molecular line radiation power</p></li>
<li><p><strong>ncol</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – ncol keyword of legend: how many columns in legend</p></li>
<li><p><strong>fac</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – scaling factor for ordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyploy.Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.plot_ue_nrate">
<code class="sig-name descname">plot_ue_nrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratefile</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 6.180343664189791</span></em>, <em class="sig-param"><span class="n">linestyle</span><span class="o">=</span><span class="default_value">'-'</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">0.1, 10000000.0</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">labelapp</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pretitle</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">figtype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'k'</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">'loglog'</span></em>, <em class="sig-param"><span class="n">idx</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ncol</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.plot_ue_nrate" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Plots the density rate coefficients read from a crumpet rate file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratefile</strong> (<em>string</em>) – path to Crumpet density rate file relative to Crumpet.path</p></li>
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – size of the created figure</p></li>
<li><p><strong>linestyle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: '-'</em><em>)</em>) – linestyle option for matplotlig.pyplot used in the plot</p></li>
<li><p><strong>savename</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name to save figure by. Figures are saved to
{Crumpet.path}/output{savename}.{figtype}. By default,
the figure is not saved.</p></li>
<li><p><strong>ylim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>1e-7</em><em>, </em><em>1e7</em><em>)</em><em>)</em>) – ordinate limits in cm**3 s**-1</p></li>
<li><p><strong>xlim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – abscissae limits in cm**3 s**-1, defaults to default limits</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – width of lines plotted</p></li>
<li><p><strong>labelapp</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – appendix for plot labels</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – </p></li>
<li><p><strong>figtype</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'png'</em><em>)</em>) – filetype to save figure as. See matplotlib.pyplot.savefig
for options</p></li>
<li><p><strong>title</strong> – figure title. Defaults to temperature and density</p></li>
<li><p><strong>pretitle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – prefix to default title, not used if title is not None</p></li>
<li><p><strong>color</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'k'</em><em>)</em>) – color to be used in plot</p></li>
<li><p><strong>plot</strong> (<em>sting</em><em>, </em><em>optional</em><em> (</em><em>default: 'loglog'</em><em>)</em>) – string of the matplotlib.pyplot.Axes plot option to be used</p></li>
<li><p><strong>idx</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Index of appearance of the data block in ratefile:
0 - atom sink
1 - atom source
2 - molecular sink
3 - molecular source
4 - external (recombination) atom source
5 - external (re-association) molecular source</p></li>
<li><p><strong>ncol</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – ncol keyword of legend: how many columns in legend</p></li>
<li><p><strong>fac</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – scaling factor for ordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyploy.Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.plotrate">
<code class="sig-name descname">plotrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">database</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">T</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">logx</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">logy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">res</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'k'</span></em>, <em class="sig-param"><span class="n">linestyle</span><span class="o">=</span><span class="default_value">'-'</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">12, 8.034446763446727</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">[1e-14, 1e-06]</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figtype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ncol</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.plotrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the rate of the requested reaction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> (<em>string</em>) – the database where to look for the rate</p></li>
<li><p><strong>name</strong> (<em>string</em>) – the handle of the reaction</p></li>
<li><p><strong>T</strong> (<em>len-2 tuple of floats</em>) – the temperature boundaries, in eV, for which to plot the
rate. Assumed to be Te or Ti, depending on the reaction</p></li>
<li><p><strong>n</strong> (<em>float</em>) – the densities, in cm**-3, for which to plot the rate.
Assumes to be ni or ne, depending on the reaction</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>logx</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – plots a logarithmic x-axis</p></li>
<li><p><strong>logy</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – plots a logarithmic y-axis</p></li>
<li><p><strong>res</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 200</em><em>)</em>) – the number of points to be sampled in the temperature
interval</p></li>
<li><p><strong>color</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'k'</em><em>)</em>) – the plot color</p></li>
<li><p><strong>linestyle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: '-'</em><em>)</em>) – the plot line style</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – size of the created figure</p></li>
<li><p><strong>savename</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name to save figure by. Figures are saved to
{Crumpet.path}/output{savename}.{figtype}. By default,
the figure is not saved.</p></li>
<li><p><strong>ylim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>1e-7</em><em>, </em><em>1e7</em><em>)</em><em>)</em>) – ordinate limits in cm**3 s**-1</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – width of lines plotted</p></li>
<li><p><strong>figtype</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'png'</em><em>)</em>) – filetype to save figure as. See matplotlib.pyplot.savefig
for options</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – the figure title</p></li>
<li><p><strong>ncol</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – ncol keyword of legend: how many columns in legend</p></li>
<li><p><strong>xlim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – abscissae limits in cm**3 s**-1, defaults to default limits</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyploy.Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.read_ue_crumpet">
<code class="sig-name descname">read_ue_crumpet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nratefile</span></em>, <em class="sig-param"><span class="n">eratefile</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.read_ue_crumpet" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Reads a CRUMPET UEDGE rate file and returns the rates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nratefile</strong> (<em>string</em>) – path to Crumpet density rate file relative to Crumpet.path</p></li>
<li><p><strong>Eratefile</strong> (<em>string</em>) – path to Crumpet energy rate file relative to Crumpet.path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dict contains the atomic and molecular density rates
and the energy rates (internal and external)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.solve_crm">
<code class="sig-name descname">solve_crm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">gl</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Qres</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">densonly</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">write</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.solve_crm" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the time-evolution of the CRM system at given T and n</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – end-time of simulation in s</p></li>
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature in eV. Default sets Ti=Te</p></li>
<li><p><strong>ni</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion density in cm**-3. Default sets ni=ne</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>gl</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – switch determining wheter to evaluate the Np x Np
Greenland CRM (True) or solve the full NxN system of
ODEs (False)</p></li>
<li><p><strong>n0</strong> (<em>list of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Initial density distribution of the species defined in the
input. List must be of the same length as the species list,
and the order is determined by the input file. Defaults to
the initial densities defined in the input if n0 is None.</p></li>
<li><p><strong>Qres</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Switch determining whether to resolve the Q-species energy
transfer or return the net energy transfer divided into
processes.</p></li>
<li><p><strong>densonly</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Only returns density rates if True, otherwise evaluates
both density and energy rates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The solution of the IVP ODE problem up to time t. A function
that interpolates the solution in the interval [0,t] is
accessed by the method sol().
The solution dimensionality along axis=0 is determined by
the CRM setup and along axis=1 by the time-resolution
according to the following:</p>
<blockquote>
<div><dl class="simple">
<dt>density=True</dt><dd><dl class="simple">
<dt>Qres=False<span class="classifier">Np</span></dt><dd><p>Data ordered according to input species list</p>
</dd>
<dt>Qres=True<span class="classifier">N (requires gl=False)</span></dt><dd><p>Data ordered according to input species list</p>
</dd>
</dl>
</dd>
<dt>density=False</dt><dd><dl class="simple">
<dt>Qres=False</dt><dd><dl class="simple">
<dt>gl=True<span class="classifier">5 + Np</span></dt><dd><p>Total Ee, Ei/a, Epot, Erada, Eradm, followed
by Np-resolved density rates</p>
</dd>
<dt>gl=False<span class="classifier">5 + N</span></dt><dd><p>Total Ee, Ei/a, Epot, Erada, Eradm, followed
by species-resolved density rates</p>
</dd>
</dl>
</dd>
<dt>Qres=True</dt><dd><dl class="simple">
<dt>gl=True<span class="classifier">5*N + Np</span></dt><dd><p>Species-resolved Ee, Ei/a, Epot, Erada,
Eradm, followed by Np-resolved density rates</p>
</dd>
<dt>gl=False<span class="classifier">6*N</span></dt><dd><p>Species-resolved Ee, Ei/a, Epot, Erada,
Eradm, followed by species-resolved density
rates</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>scipy.integrate._ivp.ivp.OdeResult object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.spectrum">
<code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">vol</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">n0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ioniz</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'l'</span></em>, <em class="sig-param"><span class="n">write</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">norm</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 6.180343664189791</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">split</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots atomic and molecular spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>vol</strong> (<em>float</em>) – volume of the domain in cm**3</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature in eV. Default sets Ti=Te</p></li>
<li><p><strong>ni</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion density in cm**-3. Default sets ni=ne</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>n0</strong> (<em>ndarray</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Initial density distribution of the species defined in the
input. List must be of the same length as the species list,
and the order is determined by the input file. Defaults to
the initial densities defined in the input if n0 is None.</p></li>
<li><p><strong>ext</strong> (<em>ndarray</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – External sinks and sources for the species, not considered
in CRUMPET, including transport, artificial sinks and
sources, etc. Must be of length Nx1, as defined by the input
species. Defaults to zeros, given in cm**-3 s**-1</p></li>
<li><p><strong>ioniz</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Additional ionization source (&lt;0) to applied to the first
species. Necessary for evaluating CRM-transport code
couplings where ionization is handled by the auxilliary
code, and not included in the CRUMPET model. Given in
cm**-3 s**-1</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – size of the created figure</p></li>
<li><p><strong>units</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: l</em><em>)</em>) – units of the plot ordinate
ev - power in eV/s
v - wavenumber cm**-1
f - frequency Hz
l - wavelength nm
Å - wavelength Å</p></li>
<li><p><strong>norm</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – normalize the lines to the total as determined by units</p></li>
<li><p><strong>split</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – split into two plots based on atomic and molecular lines</p></li>
<li><p><strong>write</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – write intensity matrix to logs</p></li>
<li><p><strong>xlim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – abscissae limits in cm**3 s**-1, defaults to default limits</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – width of lines plotted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyploy.Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.steady_state">
<code class="sig-name descname">steady_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">vol</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">gl</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">n0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ioniz</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.steady_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the steady-state population of atoms and molecules</p>
<p>Returns the ground state atom, molecule, and total vibrationally
excited molecule populations. Assumes the reactions defined for
in Crm and the external sinks and sources specified and solves
the steady-state system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>vol</strong> (<em>float</em>) – volume of the domain in cm**3</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature in eV. Default sets Ti=Te</p></li>
<li><p><strong>ni</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion density in cm**-3. Default sets ni=ne</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>gl</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – switch determining wheter to evaluate the Np x Np
Greenland CRM (True) or solve the full NxN system of ODEs
(False)</p></li>
<li><p><strong>plot</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – show a plot of the 10s time-evolution</p></li>
<li><p><strong>n0</strong> (<em>ndarray</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Initial density distribution of the species defined in the
input. List must be of the same length as the species list,
and the order is determined by the input file. Defaults to
the initial densities defined in the input if n0 is None.</p></li>
<li><p><strong>ext</strong> (<em>ndarray</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – External sinks and sources for the species, not considered
in CRUMPET, including transport, artificial sinks and
sources, etc. Must be of length Nx1, as defined by the input
species. Defaults to zeros, given in cm**-3 s**-1</p></li>
<li><p><strong>ioniz</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Additional ionization source (&lt;0) to applied to the first
species. Necessary for evaluating CRM-transport code
couplings where ionization is handled by the auxilliary
code, and not included in the CRUMPET model. Given in
cm**-3 s**-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>n_ss</strong> – steady-state populations</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.write_ue_rates">
<code class="sig-name descname">write_ue_rates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">'crumpet'</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">groundstate</span><span class="o">=</span><span class="default_value">['(n=1)', '(v=0)']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.write_ue_rates" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes UEDGE-compatible tab-delimited rate files</p>
<p>This script creates rates for H2 dissociation and H creation due
to H2. The units are s**-1: hence, the particle balance is
determined by multiplying the H2 rates by 2, and the difference
is due to MAR/MAI reactions. The files are written to a
DEGAS-style tab-delimited files with 60 temperature points and
15 density points distributed in log-log space according to
T[i]=10**(-1.2+i/10) eV for i in [0,59] and
n[j]=10**(10+j/2) cm**-3 for j in [0,14]. The files are saved in
Crumpet.path/output as {fname}_(E/n)rates.dat. To be compatible
with UEDGE only rates for Np=2, where atoms and molecules are
included are presently possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'crumpet'</em><em>)</em>) – prefix to tabulated rate data files</p></li>
<li><p><strong>E</strong> (<em>floar</em><em>, </em><em>optional</em><em> (</em><em>default: 0.1</em><em>)</em>) – assumed temperature of the molecules for rates it Tm=False</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>groundstate</strong> (<em>lst of str</em><em>, </em><em>optional</em><em> (</em><em>default=</em><em>[</em><em>'</em><em>(</em><em>n=1</em><em>)</em><em>'</em><em>, </em><em>'</em><em>(</em><em>v=0</em><em>)</em><em>'</em><em>]</em><em>)</em>) – handles for the atomic and molecular species ground state
identifier, in the order [atom, molecule]. Used to identify
the reactions associated with the atomic and molecular
ground states, in combination with Crm.isotope.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CRUMPET.Crumpet.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">'input/CRUMPET.dat'</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">vmax</span><span class="o">=</span><span class="default_value">14</span></em>, <em class="sig-param"><span class="n">nmax</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">NP</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">isotope</span><span class="o">=</span><span class="default_value">'H'</span></em>, <em class="sig-param"><span class="n">mass</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRUMPET.Crumpet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'input/CRUMPET.dat'</em><em>)</em>) – path to CRUMPET input file relative to parameter path</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: '.'</em><em>)</em>) – path to which remaing paths are relative</p></li>
<li><p><strong>vmax</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 14</em><em>)</em>) – number of excited vibrational molecular states considered</p></li>
<li><p><strong>nmax</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 8</em><em>)</em>) – number of electronic excited states considered</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – displays progress to prompt (written to a log-file too)</p></li>
<li><p><strong>NP</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 2</em><em>)</em>) – P-space size, chosen as the first NP entries of the species
card</p></li>
<li><p><strong>isotope</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'H'</em><em>)</em>) – The handle for the isotope being used. Used to identify
atomic and molecular species: molecules are taken to be
{isotope}2{groundstatemol} and atoms to be
{isotope}{groundstateatom}</p></li>
<li><p><strong>mass</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – The isotope mass in AMU, used for calculations in Crm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id0">
<code class="sig-name descname">write_ue_rates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">'crumpet'</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">groundstate</span><span class="o">=</span><span class="default_value">['(n=1)', '(v=0)']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes UEDGE-compatible tab-delimited rate files</p>
<p>This script creates rates for H2 dissociation and H creation due
to H2. The units are s**-1: hence, the particle balance is
determined by multiplying the H2 rates by 2, and the difference
is due to MAR/MAI reactions. The files are written to a
DEGAS-style tab-delimited files with 60 temperature points and
15 density points distributed in log-log space according to
T[i]=10**(-1.2+i/10) eV for i in [0,59] and
n[j]=10**(10+j/2) cm**-3 for j in [0,14]. The files are saved in
Crumpet.path/output as {fname}_(E/n)rates.dat. To be compatible
with UEDGE only rates for Np=2, where atoms and molecules are
included are presently possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: 'crumpet'</em><em>)</em>) – prefix to tabulated rate data files</p></li>
<li><p><strong>E</strong> (<em>floar</em><em>, </em><em>optional</em><em> (</em><em>default: 0.1</em><em>)</em>) – assumed temperature of the molecules for rates it Tm=False</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>groundstate</strong> (<em>lst of str</em><em>, </em><em>optional</em><em> (</em><em>default=</em><em>[</em><em>'</em><em>(</em><em>n=1</em><em>)</em><em>'</em><em>, </em><em>'</em><em>(</em><em>v=0</em><em>)</em><em>'</em><em>]</em><em>)</em>) – handles for the atomic and molecular species ground state
identifier, in the order [atom, molecule]. Used to identify
the reactions associated with the atomic and molecular
ground states, in combination with Crm.isotope.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id1">
<code class="sig-name descname">plot_depletion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'r'</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 6.25</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">'loglog'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the depletion rate for a given species</p>
<p>Plots a curve or a set of curves for the depletion rate of the
species specified by key. If both n and Te are lists, a set of
T-dependent rate curves are plotted. If either n or Te is a
float, a plot of as a function of the list is created. The
abcissa is Te regardless whether Ti is defined or not</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – handle for the species to plot depletion rate of</p></li>
<li><p><strong>n</strong> (<em>ndarray/list of floats</em><em> or </em><em>float</em>) – plasma density values in cm**-3</p></li>
<li><p><strong>Te</strong> (<em>ndarray/list of floats</em><em> or </em><em>float</em>) – electron temperature values in eV</p></li>
<li><p><strong>Ti</strong> (<em>ndarray/list of floats</em><em> or </em><em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature values in eV. Must be equal in length to
Te. If None, Ti=Te is assumed</p></li>
<li><p><strong>ax</strong> (<em>axes handle</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – axes to plot curves on. If None, a new figure is created</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>,</em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>10</em><em>,</em><em>6.25</em><em>)</em><em>)</em>) – sets figure’s figsize</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>plot</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default: loglog</em><em>)</em>) – plot layout specifier, see documentation of plotax.</p></li>
<li><p><strong>**kwargs</strong> – passed to ax.plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>if ax=None, otherwise returns None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyplot.figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id2">
<code class="sig-name descname">plot_crm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Qres</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">gl</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">density</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">14, 8.326231</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figtype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">conservation</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the CRM results for neutrals in a static background plasma</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – end-time of simulation in s</p></li>
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature in eV. Default sets Ti=Te</p></li>
<li><p><strong>ni</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion density in cm**-3. Default sets ni=ne</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>gl</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – switch determining wheter to evaluate the Np x Np
Greenland CRM (True) or solve the full NxN system of
ODEs (False)</p></li>
<li><p><strong>n0</strong> (<em>list of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Initial density distribution of the species defined in the
input. List must be of the same length as the species list,
and the order is determined by the input file. Defaults to
the initial densities defined in the input if n0 is None.</p></li>
<li><p><strong>Qres</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – Switch determining whether to resolve the Q-species energy
transfer or return the net energy transfer divided into
processes.</p></li>
<li><p><strong>density</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Only returns density rates if True, otherwise evaluates
both density and energy rates</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – Size of the created figure</p></li>
<li><p><strong>savename</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name to save figure by. Figures are saved to
{Crumpet.path}/output{savename}.{figtype}. By default,
the figure is not saved.</p></li>
<li><p><strong>figtype</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'png'</em><em>)</em>) – filetype to save figure as. See matplotlib.pyplot.savefig
for options</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Figure title</p></li>
<li><p><strong>conservation</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – Switch to also plot particle and energy conservation.
Particle conservation does not account for
recombination/ionization gains/losses</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>if fig=None, else returns None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyplot.figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id3">
<code class="sig-name descname">read_ue_crumpet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nratefile</span></em>, <em class="sig-param"><span class="n">eratefile</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Reads a CRUMPET UEDGE rate file and returns the rates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nratefile</strong> (<em>string</em>) – path to Crumpet density rate file relative to Crumpet.path</p></li>
<li><p><strong>Eratefile</strong> (<em>string</em>) – path to Crumpet energy rate file relative to Crumpet.path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dict contains the atomic and molecular density rates
and the energy rates (internal and external)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id4">
<code class="sig-name descname">plot_ue_nrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratefile</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 6.180343664189791</span></em>, <em class="sig-param"><span class="n">linestyle</span><span class="o">=</span><span class="default_value">'-'</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">0.1, 10000000.0</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">labelapp</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pretitle</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">figtype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'k'</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">'loglog'</span></em>, <em class="sig-param"><span class="n">idx</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ncol</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">fac</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Plots the density rate coefficients read from a crumpet rate file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratefile</strong> (<em>string</em>) – path to Crumpet density rate file relative to Crumpet.path</p></li>
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – size of the created figure</p></li>
<li><p><strong>linestyle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: '-'</em><em>)</em>) – linestyle option for matplotlig.pyplot used in the plot</p></li>
<li><p><strong>savename</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name to save figure by. Figures are saved to
{Crumpet.path}/output{savename}.{figtype}. By default,
the figure is not saved.</p></li>
<li><p><strong>ylim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>1e-7</em><em>, </em><em>1e7</em><em>)</em><em>)</em>) – ordinate limits in cm**3 s**-1</p></li>
<li><p><strong>xlim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – abscissae limits in cm**3 s**-1, defaults to default limits</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – width of lines plotted</p></li>
<li><p><strong>labelapp</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – appendix for plot labels</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – </p></li>
<li><p><strong>figtype</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'png'</em><em>)</em>) – filetype to save figure as. See matplotlib.pyplot.savefig
for options</p></li>
<li><p><strong>title</strong> – figure title. Defaults to temperature and density</p></li>
<li><p><strong>pretitle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – prefix to default title, not used if title is not None</p></li>
<li><p><strong>color</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'k'</em><em>)</em>) – color to be used in plot</p></li>
<li><p><strong>plot</strong> (<em>sting</em><em>, </em><em>optional</em><em> (</em><em>default: 'loglog'</em><em>)</em>) – string of the matplotlib.pyplot.Axes plot option to be used</p></li>
<li><p><strong>idx</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Index of appearance of the data block in ratefile:
0 - atom sink
1 - atom source
2 - molecular sink
3 - molecular source
4 - external (recombination) atom source
5 - external (re-association) molecular source</p></li>
<li><p><strong>ncol</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – ncol keyword of legend: how many columns in legend</p></li>
<li><p><strong>fac</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – scaling factor for ordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyploy.Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id5">
<code class="sig-name descname">calc_ue_nrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">E</span></em>, <em class="sig-param"><span class="n">Tm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id5" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Calculates the Greenland CRM particle rate coefficients</p>
<p>Includes external sources</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a dict of rate coefficients, with the corresponding
handles:
H0_depl - atom sink
H0_create - atom source
H2_depl - molecular sink
H2_create - molecular source
H0_ext - external (recombination) atom source
H2_ext - external (re-association) molecule sink</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id6">
<code class="sig-name descname">calc_ue_erate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">E</span></em>, <em class="sig-param"><span class="n">Tm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id6" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Calculates the Greenland CRM energy rate coefficients</p>
<p>Includes external sources</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a dict of rate coefficients, with the corresponding
handles:
Hel - electron energy sink/source due to atoms
H2el - electron energy sink/source due to molecules
extel - external electron energy sink/source
Hia - ion/atom energy sink/source due to atoms
H2ia - ion/atom energy sink/source due to molecules
extia - external ion/atom energy sink/source
HV - potential energy sink/source due to atoms
H2V - potential energy sink/source due to molecules
extV - external potential energy sink/source
Hga - atomic line radiation power due to atoms
H2ga - atomic line radiation power due to molecules
extga - external atomic line radiation power
Hgm - molecular line radiation power due to atoms
H2gm - molecular line radiation power due to molecules
extgm - external molecular line radiation power</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id7">
<code class="sig-name descname">plot_ue_erate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratefile</span></em>, <em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">origUE</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">idx</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Tm</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">12, 8.034446763446727</span></em>, <em class="sig-param"><span class="n">linestyle</span><span class="o">=</span><span class="default_value">'-'</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">1e-17, 1e-11</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">labelapp</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pretitle</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">figtype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">'loglog'</span></em>, <em class="sig-param"><span class="n">ncol</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">colors</span><span class="o">=</span><span class="default_value">['darkcyan', 'b', 'm', 'r']</span></em>, <em class="sig-param"><span class="n">eion</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">ediss</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id7" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Plots the energy rate coefficients read from a crumpet rate file</p>
<p>Plots the energy rate coefficients for the process with idx, as
explained below. Reads a CRUMPET energy rate file if origUE is
False, or emulates the original UEDGE calculation based on a
CRUMPET density rate file if origUE is True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratefile</strong> (<em>string</em>) – path to Crumpet density rate file relative to Crumpet.path.
Energy file if origUE=False, density file if origUE=True</p></li>
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Tm</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – local molecular temperature for calculating energy losses
associated with molecules. Defaults to E if Tm=0.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – size of the created figure</p></li>
<li><p><strong>linestyle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: '-'</em><em>)</em>) – linestyle option for matplotlig.pyplot used in the plot</p></li>
<li><p><strong>savename</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name to save figure by. Figures are saved to
{Crumpet.path}/output{savename}.{figtype}. By default,
the figure is not saved.</p></li>
<li><p><strong>ylim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>1e-7</em><em>, </em><em>1e7</em><em>)</em><em>)</em>) – ordinate limits in cm**3 s**-1</p></li>
<li><p><strong>xlim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – abscissae limits in cm**3 s**-1, defaults to default limits</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – width of lines plotted</p></li>
<li><p><strong>labelapp</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – appendix for plot labels</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – </p></li>
<li><p><strong>figtype</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'png'</em><em>)</em>) – filetype to save figure as. See matplotlib.pyplot.savefig
for options</p></li>
<li><p><strong>title</strong> – figure title. Defaults to temperature and density</p></li>
<li><p><strong>pretitle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – prefix to default title, not used if title is not None</p></li>
<li><p><strong>color</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'k'</em><em>)</em>) – color to be used in plot</p></li>
<li><p><strong>plot</strong> (<em>sting</em><em>, </em><em>optional</em><em> (</em><em>default: 'loglog'</em><em>)</em>) – string of the matplotlib.pyplot.Axes plot option to be used</p></li>
<li><p><strong>origUE</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – switch to use the original UEDGE dissociation rate (True)
or not (False). calculated based on eion and ediss</p></li>
<li><p><strong>eion</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 5</em><em>)</em>) – Value of bbb.eion used in UEDGE: ion birth energy</p></li>
<li><p><strong>ediss</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 10</em><em>)</em>) – Value of bbb.ediss used in UEDGE: molecular dissociation
energy</p></li>
<li><p><strong>colors</strong> (<em>list of strings</em><em>, </em><em>optiona</em>) – (default:[‘darkcyan’,’b’,’m’,’r’])
List of colors to be used in the plots</p></li>
<li><p><strong>idx</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 0</em><em>)</em>) – Index of appearance of the data block in ratefile:
0 - electron energy sink/source due to atoms
1 - electron energy sink/source due to molecules
2 - external electron energy sink/source
3 - ion/atom energy sink/source due to atoms
4 - ion/atom energy sink/source due to molecules
5 - external ion/atom energy sink/source
6 - potential energy sink/source due to atoms
7 - potential energy sink/source due to molecules
8 - external potential energy sink/source
9 - atomic line radiation power due to atoms
10 - atomic line radiation power due to molecules
11 - external atomic line radiation power
12 - molecular line radiation power due to atoms
13 - molecular line radiation power due to molecules
14 - external molecular line radiation power</p></li>
<li><p><strong>ncol</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – ncol keyword of legend: how many columns in legend</p></li>
<li><p><strong>fac</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 1</em><em>)</em>) – scaling factor for ordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyploy.Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id8">
<code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">vol</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">n0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ext</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ioniz</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'l'</span></em>, <em class="sig-param"><span class="n">write</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">norm</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 6.180343664189791</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">split</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id8" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots atomic and molecular spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in eV</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in cm**-3</p></li>
<li><p><strong>vol</strong> (<em>float</em>) – volume of the domain in cm**3</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature in eV. Default sets Ti=Te</p></li>
<li><p><strong>ni</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion density in cm**-3. Default sets ni=ne</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>n0</strong> (<em>ndarray</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Initial density distribution of the species defined in the
input. List must be of the same length as the species list,
and the order is determined by the input file. Defaults to
the initial densities defined in the input if n0 is None.</p></li>
<li><p><strong>ext</strong> (<em>ndarray</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – External sinks and sources for the species, not considered
in CRUMPET, including transport, artificial sinks and
sources, etc. Must be of length Nx1, as defined by the input
species. Defaults to zeros, given in cm**-3 s**-1</p></li>
<li><p><strong>ioniz</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Additional ionization source (&lt;0) to applied to the first
species. Necessary for evaluating CRM-transport code
couplings where ionization is handled by the auxilliary
code, and not included in the CRUMPET model. Given in
cm**-3 s**-1</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – size of the created figure</p></li>
<li><p><strong>units</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: l</em><em>)</em>) – units of the plot ordinate
ev - power in eV/s
v - wavenumber cm**-1
f - frequency Hz
l - wavelength nm
Å - wavelength Å</p></li>
<li><p><strong>norm</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – normalize the lines to the total as determined by units</p></li>
<li><p><strong>split</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – split into two plots based on atomic and molecular lines</p></li>
<li><p><strong>write</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: False</em><em>)</em>) – write intensity matrix to logs</p></li>
<li><p><strong>xlim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – abscissae limits in cm**3 s**-1, defaults to default limits</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – width of lines plotted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyploy.Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id9">
<code class="sig-name descname">plotrate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">database</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">T</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">logx</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">logy</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">res</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'k'</span></em>, <em class="sig-param"><span class="n">linestyle</span><span class="o">=</span><span class="default_value">'-'</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">12, 8.034446763446727</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">[1e-14, 1e-06]</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">savename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figtype</span><span class="o">=</span><span class="default_value">'png'</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ncol</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id9" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the rate of the requested reaction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> (<em>string</em>) – the database where to look for the rate</p></li>
<li><p><strong>name</strong> (<em>string</em>) – the handle of the reaction</p></li>
<li><p><strong>T</strong> (<em>len-2 tuple of floats</em>) – the temperature boundaries, in eV, for which to plot the
rate. Assumed to be Te or Ti, depending on the reaction</p></li>
<li><p><strong>n</strong> (<em>float</em>) – the densities, in cm**-3, for which to plot the rate.
Assumes to be ni or ne, depending on the reaction</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>logx</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – plots a logarithmic x-axis</p></li>
<li><p><strong>logy</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – plots a logarithmic y-axis</p></li>
<li><p><strong>res</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 200</em><em>)</em>) – the number of points to be sampled in the temperature
interval</p></li>
<li><p><strong>color</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'k'</em><em>)</em>) – the plot color</p></li>
<li><p><strong>linestyle</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: '-'</em><em>)</em>) – the plot line style</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.figure</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – figure which to plot on. By default creates a new figure and
returns the figure handle</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> (</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>14</em><em>, </em><em>8.33</em><em>)</em><em>)</em>) – size of the created figure</p></li>
<li><p><strong>savename</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – Name to save figure by. Figures are saved to
{Crumpet.path}/output{savename}.{figtype}. By default,
the figure is not saved.</p></li>
<li><p><strong>ylim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default:</em><em> (</em><em>1e-7</em><em>, </em><em>1e7</em><em>)</em><em>)</em>) – ordinate limits in cm**3 s**-1</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – width of lines plotted</p></li>
<li><p><strong>figtype</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: 'png'</em><em>)</em>) – filetype to save figure as. See matplotlib.pyplot.savefig
for options</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default: ''</em><em>)</em>) – the figure title</p></li>
<li><p><strong>ncol</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default: 3</em><em>)</em>) – ncol keyword of legend: how many columns in legend</p></li>
<li><p><strong>xlim</strong> (<em>len-2 tuple of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – abscissae limits in cm**3 s**-1, defaults to default limits</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.pyploy.Figure object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id10">
<code class="sig-name descname">lifetimes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Te</span></em>, <em class="sig-param"><span class="n">ne</span></em>, <em class="sig-param"><span class="n">E</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">Ti</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ni</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Sext</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id10" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>INCOMPLETE</strong> Species lifetimes perturbation from equilibrium</p>
<p>Retrurns a ordered list (according to the input file species) of
the species lifetimes. The species lifetimes are calculated by
an intial guess and a set of sink/source terms that are evolved
to a steady-state. Each species of the steady-state distribution
is then perturbed in order, and a exponential fit is applied to
the decay of the perturbation, determining the lifetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Te</strong> (<em>float</em>) – electron temperature in J</p></li>
<li><p><strong>ne</strong> (<em>float</em>) – electron density in m**-3</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion temperature in eV. Default sets Ti=Te</p></li>
<li><p><strong>ni</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – ion density in cm**-3. Default sets ni=ne</p></li>
<li><p><strong>E</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default: E=0.1</em><em>)</em>) – molecular energy in eV for rates</p></li>
<li><p><strong>Sext</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default: True</em><em>)</em>) – switch for considering ‘external’ sinks/sources (e.g.
re-association)</p></li>
<li><p><strong>n</strong> (<em>list of floats</em><em>, </em><em>optional</em><em> (</em><em>default: None</em><em>)</em>) – an initial guess for the steady-state densities of length N.
Defaults to n0 defined in the input</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radiative lifetimes of each species as calculated by fitting
an exponential to the decay of the perturbation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of floats</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="CRUMPET.Crm.html" class="btn btn-neutral float-right" title="Crm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../documentation.html" class="btn btn-neutral float-left" title="CRUMPET Classes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Andreas Holm

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>